# -*- coding: utf-8 -*-
"""Untitled10.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1enwhqnwllUtTbvFIZJ9w8rciH-NjN9LG
"""

pip install keras-facenet tensorflow tf2onnx onnx

import os
import numpy as np
from PIL import Image
from keras_facenet import FaceNet
import json

# Load FaceNet model
embedder = FaceNet()
model = embedder.model
print("FaceNet model loaded.")

# Preprocess image (resize to 160x160, normalize)
def preprocess_image(image_path):
    img = Image.open(image_path).convert('RGB').resize((160, 160))
    img_array = np.asarray(img).astype('float32')
    mean, std = img_array.mean(), img_array.std()
    img_array = (img_array - mean) / std
    img_array = np.expand_dims(img_array, axis=0)  # shape: (1, 160, 160, 3)
    return img_array

# Extract embeddings from multiple images for a given email
def extract_embeddings(user_email, image_paths):
    result = {user_email: []}
    for path in image_paths:
        try:
            img_array = preprocess_image(path)
            embedding = model.predict(img_array)[0]  # 128-d embedding
            result[user_email].append({
                "image": os.path.basename(path),
                "embedding": embedding.tolist()
            })
            print(f"Processed: {path}")
        except Exception as e:
            print(f"Failed to process {path}: {e}")
    return result

# Example usage
if __name__ == "__main__":
    user_email = "ankit@gmail.com"
    folder = os.path.join("/content/sample_data/Dataset", user_email)
    image_files = [os.path.join(folder, f) for f in os.listdir(folder) if f.endswith(('.jpg', '.png'))]

    output = extract_embeddings(user_email, image_files)

    # Save to JSON for inspection or testing
    with open("embeddings_output.json", "w") as f:
        json.dump(output, f, indent=2)

    print("Facial embeddings extracted and saved.")

import tensorflow as tf
import tf2onnx
import onnx
from keras_facenet import FaceNet

# Load the FaceNet Keras model
embedder = FaceNet()
model = embedder.model
print("Loaded FaceNet model for ONNX conversion.")

# Define input signature: FaceNet expects input shape (None, 160, 160, 3)
spec = (tf.TensorSpec((None, 160, 160, 3), tf.float32, name="input"),)

# Convert Keras model to ONNX
onnx_model_path = "facenet.onnx"
model_proto, _ = tf2onnx.convert.from_keras(model, input_signature=spec, opset=13)

# Save the ONNX model
onnx.save(model_proto, onnx_model_path)
print(f"FaceNet model converted and saved to {onnx_model_path}")

pip install onnxruntime

import onnxruntime as ort
import numpy as np
from PIL import Image

def preprocess_image(image_path):
    img = Image.open(image_path).convert('RGB').resize((160,160))
    img_array = np.asarray(img).astype('float32')
    mean, std = img_array.mean(), img_array.std()
    img_array = (img_array - mean) / std
    img_array = np.expand_dims(img_array, axis=0)
    return img_array

# Load ONNX model
sess = ort.InferenceSession("/content/facenet.onnx")

# Test image
img_tensor = preprocess_image("/content/sample_data/Dataset/ankit@gmail.com/Img11.png")

# Run inference
input_name = sess.get_inputs()[0].name
embedding = sess.run(None, {input_name: img_tensor})[0]

print("Embedding shape:", embedding.shape)
print("Embedding vector:", embedding.flatten()[:5])  # print first 5 values

import numpy as np

def euclidean_distance(emb1, emb2):
    return np.linalg.norm(emb1 - emb2)

def cosine_similarity(emb1, emb2):
    emb1_norm = emb1 / np.linalg.norm(emb1)
    emb2_norm = emb2 / np.linalg.norm(emb2)
    return np.dot(emb1_norm, emb2_norm)

# Example embeddings (512-D numpy arrays)
embedding1 = np.array([ -0.06949670612812042,
        0.012994982302188873,
        -0.0059031033888459206,
        0.06618604063987732,
        0.03986138477921486,
        -0.03509274125099182,
        -0.05979553610086441,
        -0.026354413479566574,
        -0.023430276662111282,
        0.059074629098176956,
        -0.011890234425663948,
        0.013963732868432999,
        -0.046195320785045624,
        0.029966071248054504,
        0.06910693645477295,
        -0.04615926742553711,
        -0.03135920688509941,
        0.09288720041513443,
        0.022819507867097855,
        -0.009469762444496155,
        -0.026618365198373795,
        0.02399432845413685,
        0.033299803733825684,
        -0.02519376575946808,
        -0.011592118069529533,
        0.040512796491384506,
        -0.020386820659041405,
        -0.04707184433937073,
        0.054138071835041046,
        0.02562781609594822,
        -0.05139440670609474,
        0.0223408043384552,
        -0.0022118634078651667,
        0.01615925133228302,
        -0.05907665938138962,
        -0.036953769624233246,
        -0.014215302653610706,
        -0.016253115609288216,
        -0.07263368368148804,
        0.10146155953407288,
        -0.06747971475124359,
        0.021123366430401802,
        -0.05379470810294151,
        0.08801623433828354,
        -0.006860746536403894,
        -0.013217605650424957,
        0.043884988874197006,
        0.07325045019388199,
        -0.10070770978927612,
        -0.00041038086055777967,
        -0.03404678776860237,
        -0.010411502793431282,
        0.053003694862127304,
        0.014163468033075333,
        -0.0036632081028074026,
        -0.020280975848436356,
        -0.010254396125674248,
        0.06117774173617363,
        -0.03292595595121384,
        -0.04276970773935318,
        -0.013167023658752441,
        0.011097749695181847,
        -0.03708172217011452,
        -0.07880426198244095,
        0.005282980855554342,
        0.016424255445599556,
        -0.09874188154935837,
        0.01677459478378296,
        -0.10462702810764313,
        0.007795023266226053,
        0.048533860594034195,
        0.04790368303656578,
        0.004071714822202921,
        -0.027478938922286034,
        0.02772161364555359,
        -0.008602270856499672,
        -0.004891691263765097,
        0.03815799206495285,
        0.012913145124912262,
        -0.007189144380390644,
        0.06619685888290405,
        -0.00654418021440506,
        0.027602264657616615,
        0.01689126528799534,
        -0.03868858516216278,
        0.03513967990875244,
        -0.0747700035572052,
        0.09391237050294876,
        -0.043051827698946,
        0.003585771657526493,
        0.08448225259780884,
        0.017101900652050972,
        0.009778358042240143,
        -0.01072120014578104,
        0.059049926698207855,
        -0.015352869406342506,
        0.01724439673125744,
        0.055266041308641434,
        -0.021233586594462395,
        0.05209280177950859,
        0.029552046209573746,
        -0.017153829336166382,
        0.024216702207922935,
        -0.010983919724822044,
        0.012573632411658764,
        0.002930606948211789,
        -0.00934764463454485,
        -0.03444835543632507,
        -0.04727255553007126,
        -0.041936058551073074,
        0.03547857701778412,
        0.023999333381652832,
        -0.04300447553396225,
        0.0138442637398839,
        -0.017840834334492683,
        0.06923100352287292,
        0.02145611308515072,
        0.041176605969667435,
        -0.058284543454647064,
        0.030567269772291183,
        0.02822558954358101,
        0.001748806913383305,
        0.04615076258778572,
        0.03940099850296974,
        0.002836967119947076,
        -0.06573369354009628,
        -0.021527569741010666,
        0.0038305618800222874,
        0.055013567209243774,
        -0.03542314097285271,
        0.036514099687337875,
        -0.03280361369252205,
        0.10949012637138367,
        0.01766960881650448,
        -0.010173989459872246,
        -0.0008181976736523211,
        0.03843625634908676,
        -0.037319738417863846,
        -0.03716399148106575,
        0.015410177409648895,
        -0.0837857574224472,
        0.043930843472480774,
        -0.051055170595645905,
        0.03424153849482536,
        0.0746573805809021,
        0.04920554906129837,
        -0.0038256703410297632,
        -0.018092108890414238,
        -0.0005186519701965153,
        -0.036449018865823746,
        -0.016863541677594185,
        0.032112836837768555,
        -0.06692002713680267,
        0.00318025890737772,
        0.048894237726926804,
        -0.032907720655202866,
        -0.031810518354177475,
        0.03577170893549919,
        -0.02278585359454155,
        -0.05610065907239914,
        0.02210244908928871,
        0.03262259438633919,
        -0.02735867165029049,
        0.06973595917224884,
        0.015049158595502377,
        0.05551149323582649,
        -0.09042942523956299,
        -0.0011191393714398146,
        -0.06324531137943268,
        0.02045079879462719,
        -0.028720399364829063,
        -0.08691214770078659,
        0.011833679862320423,
        0.028661353513598442,
        -0.07739685475826263,
        -0.04136504977941513,
        0.04350324347615242,
        -0.018639633432030678,
        -0.080472931265831,
        0.0012099212035536766,
        0.05768296867609024,
        -0.030107470229268074,
        0.03740108385682106,
        0.06579064577817917,
        0.048070453107357025,
        -0.009320448152720928,
        0.05558113381266594,
        -0.012783735059201717,
        0.0450388640165329,
        0.0049661798402667046,
        0.003065938362851739,
        0.03241509944200516,
        0.09294935315847397,
        0.0660843476653099,
        -0.012371668592095375,
        0.021777646616101265,
        -0.06890584528446198,
        -0.003945153672248125,
        -0.0014222755562514067,
        0.06310633569955826,
        0.037495650351047516,
        -0.05941475182771683,
        -0.01878194883465767,
        -0.028178034350275993,
        -0.054161787033081055,
        -0.01823040097951889,
        0.07668652385473251,
        0.01622730866074562,
        0.04703126847743988,
        -0.004415185656398535,
        -0.03166956827044487,
        -0.017484577372670174,
        -0.01464497298002243,
        0.07197245210409164,
        0.013783982954919338,
        -0.006892595440149307,
        0.029388993978500366,
        0.041983190923929214,
        -0.035648055374622345,
        0.0040763141587376595,
        -0.07008393108844757,
        -0.010693904012441635,
        0.03774118423461914,
        -0.07639966160058975,
        0.005538896657526493,
        0.0011419318616390228,
        -0.001107029733248055,
        0.02025020308792591,
        -0.014844853430986404,
        0.05688270926475525,
        -0.06376098841428757,
        0.05554889887571335,
        -0.02435174770653248,
        -0.0023057416547089815,
        -0.049521222710609436,
        0.012405582703649998,
        0.008040129207074642,
        0.028979701921343803,
        0.02023700438439846,
        -0.004451579414308071,
        -0.10711784660816193,
        -0.03476954251527786,
        -0.05213853716850281,
        0.09652511030435562,
        -0.020552629604935646,
        0.06403805315494537,
        -0.011303376406431198,
        0.020304543897509575,
        0.03646505996584892,
        0.04557894170284271,
        0.08491570502519608,
        0.04335671663284302,
        0.02649439498782158,
        -0.03662034124135971,
        -0.03859005123376846,
        0.07537184655666351,
        -0.021950792521238327,
        0.07398287951946259,
        0.05018891766667366,
        -0.008070593699812889,
        -0.030059214681386948,
        -0.022803863510489464,
        -0.032071564346551895,
        0.095139279961586,
        -0.03808470442891121,
        0.000967644911725074,
        0.04695374518632889,
        -0.0632660984992981,
        -0.04572540149092674,
        0.04435015097260475,
        -0.01618969440460205,
        -0.07830014079809189,
        -0.0407855324447155,
        0.016454199329018593,
        -0.01837800443172455,
        -0.010056717321276665,
        0.01364940870553255,
        0.07985082268714905,
        0.024732680991292,
        0.07149755954742432,
        0.05663440376520157,
        -0.0018927387427538633,
        -0.08250484615564346,
        0.010834945365786552,
        0.0037729316391050816,
        0.0544707253575325,
        -0.0006326657603494823,
        -0.07314727455377579,
        0.051729440689086914,
        -0.04107778146862984,
        0.021955017000436783,
        -0.04208316653966904,
        0.058093827217817307,
        0.04059813916683197,
        -0.06644255667924881,
        -0.04967517405748367,
        0.004087111912667751,
        -0.03476817160844803,
        0.012176266871392727,
        0.08714105933904648,
        -0.038479726761579514,
        0.035105716437101364,
        0.01908617652952671,
        0.06535585969686508,
        0.056643299758434296,
        -0.04177163168787956,
        0.03433743491768837,
        0.04137003794312477,
        -0.08615100383758545,
        -0.03969162330031395,
        -0.06201175972819328,
        0.11243080347776413,
        0.052138328552246094,
        0.06467118859291077,
        0.060678765177726746,
        0.04135598614811897,
        -0.012011055834591389,
        -0.06202934309840202,
        0.018412766978144646,
        0.07290969043970108,
        -0.0027434341609477997,
        0.054167330265045166,
        -0.023541295900940895,
        0.08204062283039093,
        -0.03550858423113823,
        -0.01433496456593275,
        0.03549659252166748,
        0.046533938497304916,
        -0.015905285254120827,
        0.08035875856876373,
        -0.017407961189746857,
        -0.0008693212876096368,
        -0.051919545978307724,
        0.002108384622260928,
        -0.0838576927781105,
        -0.02736516296863556,
        -0.02603112906217575,
        0.010324445553123951,
        -0.014762166887521744,
        -0.030317053198814392,
        -0.05335800349712372,
        0.0644148513674736,
        0.02555186301469803,
        0.04454397037625313,
        0.04419880360364914,
        0.013943259604275227,
        -0.07195339351892471,
        0.04375423491001129,
        0.0706358551979065,
        0.03236823529005051,
        0.01280247326940298,
        0.025616485625505447,
        -0.06651424616575241,
        -0.02292550913989544,
        -0.007609549909830093,
        0.02814312092959881,
        -0.03379282355308533,
        0.0050856973975896835,
        0.04417712241411209,
        -0.006571785546839237,
        -0.0008142239530570805,
        -0.03741024062037468,
        -0.059818707406520844,
        0.03230841085314751,
        0.022721542045474052,
        -0.006199434865266085,
        0.010707013309001923,
        0.028212646022439003,
        -0.009218794293701649,
        -0.027536548674106598,
        -0.0017880047671496868,
        -0.04382220655679703,
        0.05378951504826546,
        -0.0009689134894870222,
        0.033426783978939056,
        0.025023963302373886,
        -0.026096539571881294,
        -0.01726044900715351,
        0.0029912942554801702,
        -0.06814117729663849,
        0.03535451740026474,
        -0.09199876338243484,
        0.01942203752696514,
        0.020045116543769836,
        -0.052006542682647705,
        -0.026141013950109482,
        -0.06717725098133087,
        -0.07512829452753067,
        0.024575363844633102,
        0.008347267284989357,
        -0.0032825549133121967,
        -0.011345126666128635,
        0.09536458551883698,
        -0.03495302051305771,
        0.027973368763923645,
        -0.013325105421245098,
        -0.016119346022605896,
        0.028814656659960747,
        -0.00719371298328042,
        -0.016868500038981438,
        -0.05407227575778961,
        0.04861268773674965,
        0.016541989520192146,
        0.0009170528501272202,
        0.01126712653785944,
        -0.008006631396710873,
        0.007545469794422388,
        0.006850164849311113,
        0.01691286452114582,
        0.06853480637073517,
        -0.023254724219441414,
        0.008893843740224838,
        -0.003970392048358917,
        -0.016906747594475746,
        0.014858776703476906,
        0.079326331615448,
        -0.008358946070075035,
        -0.02913377806544304,
        -0.005514220334589481,
        -0.055298589169979095,
        -0.023116882890462875,
        -0.008880083449184895,
        0.0118908965960145,
        0.019978847354650497,
        -0.06446938961744308,
        0.01893402449786663,
        0.02036871761083603,
        -0.0316803976893425,
        0.01139917317777872,
        0.023219600319862366,
        0.024755598977208138,
        0.03069700300693512,
        -0.0067287166602909565,
        0.005297428462654352,
        -0.03917265310883522,
        0.005093736574053764,
        -0.022122159600257874,
        -0.06491769105195999,
        -0.03596419468522072,
        0.019020143896341324,
        0.018793392926454544,
        0.02530994452536106,
        -0.08342433720827103,
        0.009645364247262478,
        0.00045582192251458764,
        0.016735561192035675,
        -0.06520786881446838,
        -0.03743225708603859,
        -0.035479675978422165,
        -0.06561891734600067,
        0.006598358042538166,
        0.11057538539171219,
        -0.048779163509607315,
        -0.010964229702949524,
        0.08680080622434616,
        0.014923203736543655,
        -0.00691069895401597,
        0.061139293015003204,
        0.11013446748256683,
        0.0030352657195180655,
        0.07954265922307968,
        0.026290537789463997,
        -0.026690250262618065,
        -0.031154949218034744,
        0.07877568155527115,
        0.017761696130037308,
        -0.06053871288895607,
        0.008474987000226974,
        0.024079687893390656,
        0.07008012384176254,
        -0.06122059002518654,
        -0.014588480815291405,
        -0.006480014882981777,
        -0.06425444781780243,
        -0.00048339919885620475,
        -0.056536462157964706,
        0.026865141466259956,
        -0.030020473524928093,
        0.020020365715026855,
        0.14225523173809052,
        0.02185644395649433,
        -0.0065154219046235085,
        -0.02596065029501915,
        0.06202828511595726,
        0.07982409745454788,
        -0.0023916964419186115,
        -0.029174264520406723,
        -0.01681450754404068,
        0.05722935125231743,
        -0.01474793441593647,
        -0.034414008259773254,
        -0.03259840980172157,
        -0.05672687292098999,
        -0.02120533213019371,
        -0.005826841574162245,
        -0.08272787928581238,
        0.015208377502858639,
        0.08856987208127975,
        0.02039751224219799,
        -0.003921043127775192,
        -0.0971200093626976,
        0.0013394034467637539,
        0.03996077552437782,
        0.02828201651573181,
        -0.0671013668179512,
        0.043392591178417206,
        -0.01427960954606533,
        0.01437192689627409,
        -0.0033890774939209223,
        -0.06051378324627876,
        0.04889827221632004,
        -0.04271632432937622])  # embedding from image 1
embedding2 = np.array([ -0.027892278507351875,
        0.09092746675014496,
        -0.015296554192900658,
        0.036718666553497314,
        0.11472252011299133,
        0.0007761644665151834,
        -0.03508688881993294,
        0.0756940171122551,
        0.024114813655614853,
        0.11343033611774445,
        0.027170846238732338,
        -0.02613660879433155,
        -0.04574685916304588,
        -0.019762573763728142,
        -0.0018391647608950734,
        -0.016517166048288345,
        0.000582657172344625,
        0.006295567378401756,
        -0.06740830093622208,
        0.016377609223127365,
        0.016239183023571968,
        0.09255572408437729,
        0.01932520791888237,
        -0.044391848146915436,
        -0.05142015963792801,
        0.029359135776758194,
        0.061994098126888275,
        -0.0009060544543899596,
        -0.007960393093526363,
        -0.014464310370385647,
        -0.04747191071510315,
        0.018656278029084206,
        0.01602877676486969,
        -0.013955557718873024,
        0.03563996031880379,
        0.01351677905768156,
        0.04504585266113281,
        -0.06089876592159271,
        0.013102886267006397,
        -0.05451277643442154,
        -0.027300849556922913,
        0.07075154036283493,
        0.08438456058502197,
        -0.005381064489483833,
        -0.02391413412988186,
        0.036847811192274094,
        0.010827755555510521,
        0.02149977721273899,
        -0.08467579632997513,
        -0.010865779593586922,
        0.06227443739771843,
        -0.028869643807411194,
        0.06670557707548141,
        -0.03902430459856987,
        -0.054217323660850525,
        0.0016672256169840693,
        -0.0544644370675087,
        0.01703954115509987,
        -0.049535539001226425,
        -0.056009724736213684,
        0.009848532266914845,
        -0.006189285311847925,
        -0.09811657667160034,
        -0.052857547998428345,
        -0.11882495880126953,
        -0.08856473118066788,
        -0.061083633452653885,
        0.05888878554105759,
        0.0972934141755104,
        0.061355311423540115,
        0.01826869323849678,
        -0.020916420966386795,
        -0.05903303995728493,
        -0.054293084889650345,
        0.06711354851722717,
        -0.03362385556101799,
        -0.04965817928314209,
        0.02063090167939663,
        -0.027233287692070007,
        0.00770270312204957,
        0.04080599918961525,
        0.026041271165013313,
        -0.014171375893056393,
        -0.07479120045900345,
        -0.04957712069153786,
        0.05901775881648064,
        -0.010540279559791088,
        -0.010019807144999504,
        -0.03141595050692558,
        0.04161534458398819,
        -0.09086965769529343,
        -0.002976716263219714,
        0.040088921785354614,
        -0.02077491581439972,
        0.021589603275060654,
        0.054513346403837204,
        0.04583737626671791,
        0.03726254403591156,
        0.0018287214916199446,
        -0.042325038462877274,
        -0.017951175570487976,
        0.12204675376415253,
        0.006440450437366962,
        0.010897202417254448,
        0.038436293601989746,
        -0.034829575568437576,
        -0.03421313315629959,
        -0.06107389181852341,
        0.04332965612411499,
        -0.03289668634533882,
        0.07533547282218933,
        -0.01629730686545372,
        0.012665149755775928,
        -0.07958536595106125,
        0.05263930931687355,
        0.05715470016002655,
        0.08443688601255417,
        0.021380765363574028,
        0.011449657380580902,
        -0.01295088604092598,
        0.03367264196276665,
        0.01021796278655529,
        -0.031785644590854645,
        -0.011150911450386047,
        0.04478769749403,
        -0.05709277093410492,
        0.04872766509652138,
        0.011383595876395702,
        -0.03235417976975441,
        -0.008302101865410805,
        0.004658903926610947,
        0.08333009481430054,
        0.02523050829768181,
        -0.09083002060651779,
        0.032235778868198395,
        -0.008542995899915695,
        0.0073718177154660225,
        -0.034339867532253265,
        0.004127896390855312,
        0.09129118174314499,
        -0.026019854471087456,
        -0.01407642662525177,
        -0.061696767807006836,
        0.028041061013936996,
        0.0019300116691738367,
        0.021164577454328537,
        0.022696522995829582,
        -0.007172040641307831,
        0.0048845428973436356,
        -0.01708914525806904,
        -0.015257605351507664,
        -0.038096193224191666,
        -0.028908416628837585,
        0.008868786506354809,
        0.04396180436015129,
        0.0193666722625494,
        -0.020415015518665314,
        0.06010877341032028,
        0.01636585034430027,
        -0.06390576809644699,
        0.08156464993953705,
        0.02161460928618908,
        -0.021605953574180603,
        -0.010684776119887829,
        0.044350359588861465,
        -0.02545980177819729,
        -0.015094672329723835,
        -0.03064185194671154,
        -0.020950907841324806,
        0.03849000856280327,
        0.011088819243013859,
        -0.01646501198410988,
        -0.037254832684993744,
        0.03394710645079613,
        0.035770636051893234,
        0.02941228449344635,
        -0.01782422885298729,
        -0.005844905506819487,
        -0.0406644232571125,
        0.0018788805464282632,
        -0.016996417194604874,
        -0.010495588183403015,
        -0.04464593902230263,
        -0.022410983219742775,
        0.07798227667808533,
        0.05256922170519829,
        0.003585847793146968,
        0.027100233361124992,
        0.05751430615782738,
        0.09009664505720139,
        0.02433943748474121,
        0.03799944370985031,
        0.03142625838518143,
        -0.04463020712137222,
        0.12686720490455627,
        -0.027821244671940804,
        -0.02234913595020771,
        -0.026111183688044548,
        0.018188253045082092,
        -0.018089519813656807,
        -0.006249656900763512,
        -0.08656280487775803,
        0.038083698600530624,
        -0.06863439828157425,
        -0.014432668685913086,
        0.10168276727199554,
        0.04007880017161369,
        -0.027933495119214058,
        -0.023023225367069244,
        0.018927885219454765,
        -0.02427876554429531,
        -0.0036538245622068644,
        0.047551319003105164,
        -0.09195481240749359,
        0.03661591559648514,
        0.04359474033117294,
        -0.0005715019069612026,
        -0.005367852747440338,
        -0.034791119396686554,
        -0.07021187245845795,
        0.008508510887622833,
        -0.003431586315855384,
        0.033780328929424286,
        0.057205550372600555,
        0.05754026025533676,
        -0.00488765025511384,
        -0.0400652252137661,
        0.004198112525045872,
        0.0997382253408432,
        0.038562413305044174,
        -0.004410434979945421,
        -0.007413569837808609,
        -0.013182517141103745,
        0.03171304985880852,
        0.008407865650951862,
        -0.011305008083581924,
        -0.0395626500248909,
        -0.10635104030370712,
        0.023481294512748718,
        0.0802743211388588,
        -0.007768460549414158,
        -0.0030814066994935274,
        -0.027989579364657402,
        -0.022390175610780716,
        0.040753792971372604,
        0.04705815017223358,
        -0.03199923411011696,
        -0.014825630933046341,
        0.04557809606194496,
        0.030355628579854965,
        -0.028481002897024155,
        0.02088785171508789,
        0.033798299729824066,
        -0.08642669767141342,
        0.059752143919467926,
        -0.06082366034388542,
        0.00804466288536787,
        0.02976328879594803,
        0.010800471529364586,
        -0.06942123174667358,
        -0.021433649584650993,
        -0.01111214142292738,
        0.04806288331747055,
        0.011018035933375359,
        0.008406377397477627,
        -0.051078878343105316,
        -0.006961460690945387,
        0.012423306703567505,
        0.025120675563812256,
        -0.011349236592650414,
        -0.010483908466994762,
        0.057681966572999954,
        0.012130342423915863,
        -0.020336207002401352,
        0.004647973924875259,
        0.025808103382587433,
        0.01766250468790531,
        0.09097441285848618,
        -0.012203690595924854,
        -0.018285401165485382,
        -0.010032660327851772,
        0.06757877767086029,
        0.09663673490285873,
        -0.030025459825992584,
        -0.0391630195081234,
        -0.015606774017214775,
        0.11408580839633942,
        0.021293066442012787,
        -0.07377249747514725,
        -0.044687286019325256,
        -0.023988861590623856,
        -0.02196670137345791,
        -0.0645153746008873,
        0.04256393760442734,
        -0.06663617491722107,
        -0.01437248382717371,
        0.0026852265000343323,
        0.006983091589063406,
        -0.010440606623888016,
        -0.019475487992167473,
        0.015556484460830688,
        0.06797932833433151,
        -0.10573448240756989,
        0.005792554467916489,
        0.03246520459651947,
        -0.043444737792015076,
        0.010242782533168793,
        -0.046769216656684875,
        -0.051805246621370316,
        -0.001287264283746481,
        0.02796950936317444,
        0.003757343627512455,
        -0.08904745429754257,
        -0.03388821333646774,
        0.10032129287719727,
        -0.03062577173113823,
        0.033045217394828796,
        0.039912737905979156,
        0.03999339044094086,
        -0.04388756677508354,
        0.027122437953948975,
        0.0428193137049675,
        -0.017161894589662552,
        0.025285255163908005,
        -0.05334001034498215,
        0.038747236132621765,
        0.0002735370653681457,
        0.03133826702833176,
        0.04909397289156914,
        -0.036814428865909576,
        -0.01584189385175705,
        0.009479451924562454,
        0.018720094114542007,
        0.04070347920060158,
        -0.045414336025714874,
        0.028818191960453987,
        0.01808207854628563,
        -0.030765384435653687,
        0.019472626969218254,
        -0.0584842711687088,
        0.06910504400730133,
        0.02418743632733822,
        -0.00736392755061388,
        0.07124654948711395,
        0.025777477771043777,
        -0.006884065456688404,
        -0.020669711753726006,
        0.02005746215581894,
        0.023398514837026596,
        -0.07103841006755829,
        -0.020475443452596664,
        0.025174839422106743,
        -0.035746946930885315,
        -0.013815882615745068,
        0.05567388981580734,
        -0.03695809841156006,
        -0.01839909888803959,
        0.006842359434813261,
        -0.07839995622634888,
        -0.02025301195681095,
        0.108102947473526,
        -0.01974385417997837,
        -0.07783250510692596,
        -0.029112212359905243,
        -0.0032366393133997917,
        -0.022153541445732117,
        -0.009636134840548038,
        -0.004394678398966789,
        0.05043909326195717,
        -0.036971140652894974,
        -0.052183590829372406,
        -0.030816731974482536,
        0.007146813906729221,
        -0.019718362018465996,
        -0.009126471355557442,
        0.033608876168727875,
        -0.07302527129650116,
        0.016636643558740616,
        -0.023855378851294518,
        0.02027944102883339,
        -0.0015481177251785994,
        -0.03753169998526573,
        0.019343458116054535,
        0.004399037919938564,
        0.02819601446390152,
        -0.015951598063111305,
        0.004536154679954052,
        0.03697719797492027,
        0.008205917663872242,
        -0.0034020456951111555,
        -0.025962574407458305,
        0.05366167798638344,
        -0.03288468345999718,
        0.020349405705928802,
        -0.044597938656806946,
        -0.008899841457605362,
        0.03896087035536766,
        0.04225337505340576,
        0.08626796305179596,
        -0.0003988942480646074,
        -0.0516296923160553,
        -0.03687490522861481,
        0.038601990789175034,
        -0.014541760087013245,
        0.03529254347085953,
        0.025747843086719513,
        -0.05622103437781334,
        0.05433182418346405,
        0.07564795017242432,
        -0.03590782731771469,
        0.07525091618299484,
        -0.01927340030670166,
        -0.007938924245536327,
        0.026520751416683197,
        -0.10700123757123947,
        0.034877028316259384,
        -0.016950327903032303,
        0.008334382437169552,
        0.018858933821320534,
        -0.03540946543216705,
        0.08816851675510406,
        -0.0565793551504612,
        0.019951390102505684,
        -0.05209534242749214,
        -0.043437980115413666,
        0.029070574790239334,
        -0.030553899705410004,
        -0.07949086278676987,
        -0.01341710239648819,
        -0.001994050806388259,
        -0.059162918478250504,
        -0.029100148007273674,
        0.007261650171130896,
        0.010107715614140034,
        0.044549934566020966,
        -0.08087535202503204,
        -0.03779895603656769,
        -0.02484007366001606,
        -0.054945092648267746,
        -0.025347255170345306,
        -0.035094019025564194,
        0.02802922949194908,
        -0.011498522013425827,
        0.02741779200732708,
        -0.048283010721206665,
        0.012111512944102287,
        -0.08089339733123779,
        0.03646443039178848,
        0.09218728542327881,
        -0.12501302361488342,
        0.009897126816213131,
        0.00032681439188309014,
        0.025033099576830864,
        -0.033836230635643005,
        -0.015062123537063599,
        0.01814054697751999,
        -0.0063125984743237495,
        0.046686697751283646,
        0.029577549546957016,
        0.0006354591459967196,
        0.095577172935009,
        0.055437833070755005,
        0.034771453589200974,
        -0.0034651539754122496,
        0.02241363935172558,
        0.0421169213950634,
        -0.0051503549329936504,
        -0.014029646292328835,
        -0.038893844932317734,
        -0.013629128225147724,
        -0.030441783368587494,
        -0.03222642093896866,
        -0.06807415932416916,
        -0.0285260658711195,
        -0.042508043348789215,
        0.0883399173617363,
        0.06524284183979034,
        -0.004948642570525408,
        0.0004162307595834136,
        -0.016181759536266327,
        0.011272825300693512,
        0.05795447528362274,
        -0.05939473211765289,
        -0.07772557437419891,
        0.020051244646310806,
        -0.028705593198537827,
        -0.008753553032875061,
        0.04335920885205269,
        0.020868556573987007,
        -0.06117118522524834,
        0.08098819106817245,
        -0.04964004456996918,
        0.014381160028278828,
        0.05065445601940155,
        0.038746047765016556,
        0.025318816304206848,
        0.03156649321317673,
        -0.04652785882353783,
        0.019490476697683334,
        -0.0031493499409407377,
        -0.01754617691040039,
        0.004280679859220982,
        0.07909462600946426,
        -0.04811584949493408,
        0.045310843735933304,
        0.03030207008123398,
        0.013368377462029457,
        -0.04428455978631973,
        0.060260605067014694,
        -0.051011983305215836,
        0.01453565713018179,
        0.040216755121946335])  # embedding from image 2

# Calculate distances/similarity
dist = euclidean_distance(embedding1, embedding2)
cos_sim = cosine_similarity(embedding1, embedding2)

print("Euclidean distance:", dist)
print("Cosine similarity:", cos_sim)

# Thresholds (typical)
# Euclidean distance < 1.0 usually means same person
# Cosine similarity > 0.5 to 0.7 usually means same person
if dist < 1.0:
    print("Faces MATCH")
else:
    print("Faces DO NOT MATCH")